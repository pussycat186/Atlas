<svg xmlns="http://www.w3.org/2000/svg" width="800" height="600" viewBox="0 0 800 600">
  <!-- MLS (Messaging Layer Security) Sequence Diagram -->
  <defs>
    <style>
      .title { font-family: 'Roboto', sans-serif; font-size: 24px; font-weight: bold; fill: #0A2540; }
      .label { font-family: 'Roboto', sans-serif; font-size: 14px; fill: #0A2540; }
      .actor { fill: #00D4AA; stroke: #0A2540; stroke-width: 2; }
      .line { stroke: #0A2540; stroke-width: 2; fill: none; }
      .arrow { fill: #0A2540; }
      .box { fill: #F0F0F0; stroke: #0A2540; stroke-width: 1; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="400" y="40" class="title" text-anchor="middle">MLS Sequence Diagram (RFC 9420)</text>
  <text x="400" y="65" class="label" text-anchor="middle">TreeKEM + Epochs + Group Updates</text>
  
  <!-- Actors -->
  <rect x="50" y="100" width="120" height="50" class="actor" rx="5"/>
  <text x="110" y="130" class="label" text-anchor="middle">Alice</text>
  
  <rect x="340" y="100" width="120" height="50" class="actor" rx="5"/>
  <text x="400" y="130" class="label" text-anchor="middle">Delivery Service</text>
  
  <rect x="630" y="100" width="120" height="50" class="actor" rx="5"/>
  <text x="690" y="130" class="label" text-anchor="middle">Bob</text>
  
  <!-- Lifelines -->
  <line x1="110" y1="150" x2="110" y2="550" class="line" stroke-dasharray="5,5"/>
  <line x1="400" y1="150" x2="400" y2="550" class="line" stroke-dasharray="5,5"/>
  <line x1="690" y1="150" x2="690" y2="550" class="line" stroke-dasharray="5,5"/>
  
  <!-- Messages -->
  <!-- 1. Init Group -->
  <line x1="110" y1="180" x2="400" y2="180" class="line" marker-end="url(#arrowhead)"/>
  <text x="200" y="175" class="label" font-size="12">1. KeyPackage (init_key, leaf_node)</text>
  
  <!-- 2. Add Bob -->
  <line x1="400" y1="220" x2="690" y2="220" class="line" marker-end="url(#arrowhead)"/>
  <text x="500" y="215" class="label" font-size="12">2. Welcome + GroupInfo</text>
  
  <!-- 3. Commit -->
  <rect x="80" y="250" width="60" height="30" class="box" rx="3"/>
  <text x="110" y="270" class="label" font-size="11" text-anchor="middle">Epoch 0</text>
  
  <!-- 4. Send message -->
  <line x1="110" y1="310" x2="400" y2="310" class="line" marker-end="url(#arrowhead)"/>
  <text x="200" y="305" class="label" font-size="12">3. MLSCiphertext (epoch=0)</text>
  
  <line x1="400" y1="330" x2="690" y2="330" class="line" marker-end="url(#arrowhead)"/>
  <text x="500" y="325" class="label" font-size="12">4. Deliver MLSCiphertext</text>
  
  <!-- 5. Update Path -->
  <line x1="690" y1="370" x2="400" y2="370" class="line" marker-end="url(#arrowhead)"/>
  <text x="500" y="365" class="label" font-size="12">5. Commit (UpdatePath)</text>
  
  <line x1="400" y1="390" x2="110" y2="390" class="line" marker-end="url(#arrowhead)"/>
  <text x="200" y="385" class="label" font-size="12">6. Broadcast Commit</text>
  
  <!-- 6. Epoch transition -->
  <rect x="660" y="410" width="60" height="30" class="box" rx="3"/>
  <text x="690" y="430" class="label" font-size="11" text-anchor="middle">Epoch 1</text>
  
  <rect x="80" y="410" width="60" height="30" class="box" rx="3"/>
  <text x="110" y="430" class="label" font-size="11" text-anchor="middle">Epoch 1</text>
  
  <!-- 7. New message in new epoch -->
  <line x1="110" y1="470" x2="400" y2="470" class="line" marker-end="url(#arrowhead)"/>
  <text x="200" y="465" class="label" font-size="12">7. MLSCiphertext (epoch=1)</text>
  
  <line x1="400" y1="490" x2="690" y2="490" class="line" marker-end="url(#arrowhead)"/>
  <text x="500" y="485" class="label" font-size="12">8. Deliver (new keys)</text>
  
  <!-- Legend -->
  <rect x="50" y="520" width="700" height="60" fill="none" stroke="#0A2540" stroke-width="1" rx="5"/>
  <text x="60" y="540" class="label" font-size="12" font-weight="bold">Key Properties:</text>
  <text x="60" y="560" class="label" font-size="11">• TreeKEM: Efficient group key updates (log n complexity)</text>
  <text x="400" y="560" class="label" font-size="11">• Post-Compromise Security (PCS)</text>
  <text x="60" y="575" class="label" font-size="11">• Forward Secrecy (FS)</text>
  <text x="400" y="575" class="label" font-size="11">• Asynchronous operation support</text>
  
  <!-- Arrowhead marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" class="arrow"/>
    </marker>
  </defs>
</svg>
